(function(b){b.easytabs=function(J,O){var N=this,C=b(J),K={animate:true,panelActiveClass:"active",tabActiveClass:"active",defaultTab:"li:first-child",animationSpeed:"normal",tabs:"> ul > li",updateHash:true,cycle:false,collapsible:false,collapsedClass:"collapsed",collapsedByDefault:true,uiTabs:false,transitionIn:"fadeIn",transitionOut:"fadeOut",transitionInEasing:"swing",transitionOutEasing:"swing",transitionCollapse:"slideUp",transitionUncollapse:"slideDown",transitionCollapseEasing:"swing",transitionUncollapseEasing:"swing",containerClass:"",tabsClass:"",tabClass:"",panelClass:"",cache:true,event:"click",panelContext:C},L,H,x,G,P,z={fast:200,normal:400,slow:600},B;N.init=function(){N.settings=B=b.extend({},K,O);B.bind_str=B.event+".easytabs";if(B.uiTabs){B.tabActiveClass="ui-tabs-selected";B.containerClass="ui-tabs ui-widget ui-widget-content ui-corner-all";B.tabsClass="ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all";B.tabClass="ui-state-default ui-corner-top";B.panelClass="ui-tabs-panel ui-widget-content ui-corner-bottom"}if(B.collapsible&&O.defaultTab!==undefined&&O.collpasedByDefault===undefined){B.collapsedByDefault=false}if(typeof(B.animationSpeed)==="string"){B.animationSpeed=z[B.animationSpeed]}b("a.anchor").remove().prependTo("body");C.data("easytabs",{});N.setTransitions();N.getTabs();R();M();a();F();Q();C.attr("data-easytabs",true)};N.setTransitions=function(){x=(B.animate)?{show:B.transitionIn,hide:B.transitionOut,speed:B.animationSpeed,collapse:B.transitionCollapse,uncollapse:B.transitionUncollapse,halfSpeed:B.animationSpeed/2}:{show:"show",hide:"hide",speed:0,collapse:"hide",uncollapse:"show",halfSpeed:0}};N.getTabs=function(){var c;N.tabs=C.find(B.tabs),N.panels=b(),N.tabs.each(function(){var d=b(this),e=d.children("a"),f=d.children("a").data("target");d.data("easytabs",{});if(f!==undefined&&f!==null){d.data("easytabs").ajax=e.attr("href")}else{f=e.attr("href")}f=f.match(/#([^\?]+)/)[1];c=B.panelContext.find("#"+f);if(c.length){c.data("easytabs",{position:c.css("position"),visibility:c.css("visibility")});c.not(B.panelActiveClass).hide();N.panels=N.panels.add(c);d.data("easytabs").panel=c}else{N.tabs=N.tabs.not(d);if("console" in window){console.warn("Warning: tab without matching panel for selector '#"+f+"' removed from set")}}})};N.selectTab=function(d,f){var h=window.location,g=h.hash.match(/^[^\?]*/)[0],e=d.parent().data("easytabs").panel,c=d.parent().data("easytabs").ajax;if(B.collapsible&&!P&&(d.hasClass(B.tabActiveClass)||d.hasClass(B.collapsedClass))){N.toggleTabCollapse(d,e,c,f)}else{if(!d.hasClass(B.tabActiveClass)||!e.hasClass(B.panelActiveClass)){E(d,e,c,f)}else{if(!B.cache){E(d,e,c,f)}}}};N.toggleTabCollapse=function(d,f,e,c){N.panels.stop(true,true);if(y(C,"easytabs:before",[d,f,B])){N.tabs.filter("."+B.tabActiveClass).removeClass(B.tabActiveClass).children().removeClass(B.tabActiveClass);if(d.hasClass(B.collapsedClass)){if(e&&(!B.cache||!d.parent().data("easytabs").cached)){C.trigger("easytabs:ajax:beforeSend",[d,f]);f.load(e,function(h,i,g){d.parent().data("easytabs").cached=true;C.trigger("easytabs:ajax:complete",[d,f,h,i,g])})}d.parent().removeClass(B.collapsedClass).addClass(B.tabActiveClass).children().removeClass(B.collapsedClass).addClass(B.tabActiveClass);f.addClass(B.panelActiveClass)[x.uncollapse](x.speed,B.transitionUncollapseEasing,function(){C.trigger("easytabs:midTransition",[d,f,B]);if(typeof c=="function"){c()}})}else{d.addClass(B.collapsedClass).parent().addClass(B.collapsedClass);f.removeClass(B.panelActiveClass)[x.collapse](x.speed,B.transitionCollapseEasing,function(){C.trigger("easytabs:midTransition",[d,f,B]);if(typeof c=="function"){c()}})}}};N.matchTab=function(c){return N.tabs.find("[href='"+c+"'],[data-target='"+c+"']").first()};N.matchInPanel=function(c){return(c&&N.validId(c)?N.panels.filter(":has("+c+")").first():[])};N.validId=function(c){return c.substr(1).match(/^[A-Za-z]+[A-Za-z0-9\-_:\.].$/)};N.selectTabFromHashChange=function(){var e=window.location.hash.match(/^[^\?]*/)[0],c=N.matchTab(e),d;if(B.updateHash){if(c.length){P=true;N.selectTab(c)}else{d=N.matchInPanel(e);if(d.length){e="#"+d.attr("id");c=N.matchTab(e);P=true;N.selectTab(c)}else{if(!L.hasClass(B.tabActiveClass)&&!B.cycle){if(e===""||N.matchTab(G).length||C.closest(e).length){P=true;N.selectTab(H)}}}}}};N.cycleTabs=function(c){if(B.cycle){c=c%N.tabs.length;$tab=b(N.tabs[c]).children("a").first();P=true;N.selectTab($tab,function(){setTimeout(function(){N.cycleTabs(c+1)},B.cycle)})}};N.publicMethods={select:function(c){var d;if((d=N.tabs.filter(c)).length===0){if((d=N.tabs.find("a[href='"+c+"']")).length===0){if((d=N.tabs.find("a"+c)).length===0){if((d=N.tabs.find("[data-target='"+c+"']")).length===0){if((d=N.tabs.find("a[href$='"+c+"']")).length===0){b.error("Tab '"+c+"' does not exist in tab set")}}}}}else{d=d.children("a").first()}N.selectTab(d)}};var y=function(d,c,e){var f=b.Event(c);d.trigger(f,e);return f.result!==false};var R=function(){C.addClass(B.containerClass);N.tabs.parent().addClass(B.tabsClass);N.tabs.addClass(B.tabClass);N.panels.addClass(B.panelClass)};var M=function(){var e=window.location.hash.match(/^[^\?]*/)[0],c=N.matchTab(e).parent(),d;if(c.length===1){L=c;B.cycle=false}else{d=N.matchInPanel(e);if(d.length){e="#"+d.attr("id");L=N.matchTab(e).parent()}else{L=N.tabs.parent().find(B.defaultTab);if(L.length===0){b.error("The specified default tab ('"+B.defaultTab+"') could not be found in the tab set ('"+B.tabs+"') out of "+N.tabs.length+" tabs.")}}}H=L.children("a").first();D(c)};var D=function(d){var e,c;if(B.collapsible&&d.length===0&&B.collapsedByDefault){L.addClass(B.collapsedClass).children().addClass(B.collapsedClass)}else{e=b(L.data("easytabs").panel);c=L.data("easytabs").ajax;if(c&&(!B.cache||!L.data("easytabs").cached)){C.trigger("easytabs:ajax:beforeSend",[H,e]);e.load(c,function(h,f,g){L.data("easytabs").cached=true;C.trigger("easytabs:ajax:complete",[H,e,h,f,g])})}L.data("easytabs").panel.show().addClass(B.panelActiveClass);L.addClass(B.tabActiveClass).children().addClass(B.tabActiveClass)}C.trigger("easytabs:initialised",[H,e])};var a=function(){N.tabs.children("a").bind(B.bind_str,function(c){B.cycle=false;P=false;N.selectTab(b(this));c.preventDefault?c.preventDefault():c.returnValue=false})};var E=function(g,c,m,j){N.panels.stop(true,true);if(y(C,"easytabs:before",[g,c,B])){var f=N.panels.filter(":visible"),h=c.parent(),l,i,d,k,e=window.location.hash.match(/^[^\?]*/)[0];if(B.animate){l=A(c);i=f.length?I(f):0;d=l-i}G=e;k=function(){C.trigger("easytabs:midTransition",[g,c,B]);if(B.animate&&B.transitionIn=="fadeIn"){if(d<0){h.animate({height:h.height()+d},x.halfSpeed).css({"min-height":""})}}if(B.updateHash&&!P){window.location.hash="#"+c.attr("id")}else{P=false}c[x.show](x.speed,B.transitionInEasing,function(){h.css({height:"","min-height":""});C.trigger("easytabs:after",[g,c,B]);if(typeof j=="function"){j()}})};if(m&&(!B.cache||!g.parent().data("easytabs").cached)){C.trigger("easytabs:ajax:beforeSend",[g,c]);c.load(m,function(o,p,n){g.parent().data("easytabs").cached=true;C.trigger("easytabs:ajax:complete",[g,c,o,p,n])})}if(B.animate&&B.transitionOut=="fadeOut"){if(d>0){h.animate({height:(h.height()+d)},x.halfSpeed)}else{h.css({"min-height":h.height()})}}N.tabs.filter("."+B.tabActiveClass).removeClass(B.tabActiveClass).children().removeClass(B.tabActiveClass);N.tabs.filter("."+B.collapsedClass).removeClass(B.collapsedClass).children().removeClass(B.collapsedClass);g.parent().addClass(B.tabActiveClass).children().addClass(B.tabActiveClass);N.panels.filter("."+B.panelActiveClass).removeClass(B.panelActiveClass);c.addClass(B.panelActiveClass);if(f.length){f[x.hide](x.speed,B.transitionOutEasing,k)}else{c[x.uncollapse](x.speed,B.transitionUncollapseEasing,k)}}};var A=function(e){if(e.data("easytabs")&&e.data("easytabs").lastHeight){return e.data("easytabs").lastHeight}var g=e.css("display"),f,d;try{f=b("<div></div>",{position:"absolute",visibility:"hidden",overflow:"hidden"})}catch(c){f=b("<div></div>",{visibility:"hidden",overflow:"hidden"})}d=e.wrap(f).css({position:"relative",visibility:"hidden",display:"block"}).outerHeight();e.unwrap();e.css({position:e.data("easytabs").position,visibility:e.data("easytabs").visibility,display:g});e.data("easytabs").lastHeight=d;return d};var I=function(d){var c=d.outerHeight();if(d.data("easytabs")){d.data("easytabs").lastHeight=c}else{d.data("easytabs",{lastHeight:c})}return c};var F=function(){if(typeof b(window).hashchange==="function"){b(window).hashchange(function(){N.selectTabFromHashChange()})}else{if(b.address&&typeof b.address.change==="function"){b.address.change(function(){N.selectTabFromHashChange()})}}};var Q=function(){var c;if(B.cycle){c=N.tabs.index(L);setTimeout(function(){N.cycleTabs(c+1)},B.cycle)}};N.init()};b.fn.easytabs=function(d){var a=arguments;return this.each(function(){var c=b(this),f=c.data("easytabs");if(undefined===f){f=new b.easytabs(this,d);c.data("easytabs",f)}if(f.publicMethods[d]){return f.publicMethods[d](Array.prototype.slice.call(a,1))}})}})(jQuery);